<interface id="msgf-plus-ambiguity" version="1.4.0+make_msstats_input">
	
	<download>
		<source name="mzTab/" type="folder" />
		<source name="mzTab_lib_construction/" type="folder" />
		<source name="mzTab_topk/" type="folder" />
		<source name="mzTab_topk_lib_construction/" type="folder" />
	</download>

	
	<view group="MS-GF+ Results (Includes decoys)" id="view_result_list" label="Top 1 + Ties mzTab">
		<blockRef id="main" type="file_list_top1" />
	</view>
	<view group="MS-GF+ Results (Includes decoys)" id="view_result_list_topk" label="Top K mzTab">
		<blockRef id="main" type="file_list_topk" />
	</view>
	<view group="Library Construction Inputs (Includes decoys, length-based FDR)" id="view_result_list_lib_construction" label="Top 1 + Ties mzTab">
		<blockRef id="main" type="file_list_lib_construction" />
	</view>
	<view group="Library Construction Inputs (Includes decoys, length-based FDR)" id="view_result_list_topk_lib_construction" label="Top K mzTab">
		<blockRef id="main" type="file_list_topk_lib_construction" />
	</view>
          <view group="Export" id="msstats_evidence" label="MSStats Input (Isobaric Tag)">
                <blockRef id="main" type="msstats_evidence_block" />
                  </view>

	<block id="file_list_topk" type="table">
		<data>
			<source name="statistics_topk/" type="file" />
			<parsers>
				<parser type="tabular" />
			</parsers>
		</data>
		<row>
			<column field="Uploaded_file" label="Result File" type="text" width="12" />
			<column field="Found_PSMs" label="Total PSMs" preload="Yes" type="fdrview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="PSM_FDR" />
			</column>
			<column field="Invalid_PSM_rows" label="Invalid PSMs" preload="Yes" type="numberview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22valid_input%22%3A%22INVALID%22}" />
			</column>
			<column field="Peptide_rows" label="Peptides" preload="Yes" type="fdrview" view="group_by_peptide" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Found_Peptides" label="Peptides (Derived)" preload="Yes" type="fdrview" view="group_by_peptide_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Protein_rows" label="Proteins" preload="Yes" type="fdrview" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column field="Found_Proteins" label="Proteins (Derived)" preload="Yes" type="fdrview" view="group_by_protein_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column label="&quot;One-Hit Wonders&quot;" preload="Yes" tooltip="Proteins identified by exactly one peptide." type="view" value="View" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22Peptides_lowerinput%22%3A%221%22%2C%22Peptides_upperinput%22%3A%221%22}" />
			</column>
			<column label="PTMs" preload="Yes" tooltip="Spectrum identifications, grouped by unique sets of post-translational modifications." type="view" value="View" view="group_by_ptm" width="3">
				<parameter name="file" value="[File_descriptor]" />
			</column>
		</row>
	</block>

	<block id="file_list_topk_lib_construction" type="table">
		<data>
			<source name="statistics_topk_lib_construction/" type="file" />
			<parsers>
				<parser type="tabular" />
			</parsers>
		</data>
		<row>
			<column field="Uploaded_file" label="Result File" type="text" width="12" />
			<column field="Found_PSMs" label="Total PSMs" preload="Yes" type="fdrview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="PSM_FDR" />
			</column>
			<column field="Invalid_PSM_rows" label="Invalid PSMs" preload="Yes" type="numberview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22valid_input%22%3A%22INVALID%22}" />
			</column>
			<column field="Peptide_rows" label="Peptides" preload="Yes" type="fdrview" view="group_by_peptide" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Found_Peptides" label="Peptides (Derived)" preload="Yes" type="fdrview" view="group_by_peptide_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Protein_rows" label="Proteins" preload="Yes" type="fdrview" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column field="Found_Proteins" label="Proteins (Derived)" preload="Yes" type="fdrview" view="group_by_protein_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column label="&quot;One-Hit Wonders&quot;" preload="Yes" tooltip="Proteins identified by exactly one peptide." type="view" value="View" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22Peptides_lowerinput%22%3A%221%22%2C%22Peptides_upperinput%22%3A%221%22}" />
			</column>
			<column label="PTMs" preload="Yes" tooltip="Spectrum identifications, grouped by unique sets of post-translational modifications." type="view" value="View" view="group_by_ptm" width="3">
				<parameter name="file" value="[File_descriptor]" />
			</column>
		</row>
	</block>

	<block id="file_list_lib_construction" type="table">
		<data>
			<source name="statistics_lib_construction/" type="file" />
			<parsers>
				<parser type="tabular" />
			</parsers>
		</data>
		<row>
			<column field="Uploaded_file" label="Result File" type="text" width="12" />
			<column field="Found_PSMs" label="Total PSMs" preload="Yes" type="fdrview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="PSM_FDR" />
			</column>
			<column field="Invalid_PSM_rows" label="Invalid PSMs" preload="Yes" type="numberview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22valid_input%22%3A%22INVALID%22}" />
			</column>
			<column field="Peptide_rows" label="Peptides" preload="Yes" type="fdrview" view="group_by_peptide" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Found_Peptides" label="Peptides (Derived)" preload="Yes" type="fdrview" view="group_by_peptide_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Protein_rows" label="Proteins" preload="Yes" type="fdrview" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column field="Found_Proteins" label="Proteins (Derived)" preload="Yes" type="fdrview" view="group_by_protein_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column label="&quot;One-Hit Wonders&quot;" preload="Yes" tooltip="Proteins identified by exactly one peptide." type="view" value="View" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22Peptides_lowerinput%22%3A%221%22%2C%22Peptides_upperinput%22%3A%221%22}" />
			</column>
			<column label="PTMs" preload="Yes" tooltip="Spectrum identifications, grouped by unique sets of post-translational modifications." type="view" value="View" view="group_by_ptm" width="3">
				<parameter name="file" value="[File_descriptor]" />
			</column>
		</row>
	</block>

	<block id="file_list_top1" type="table">
		<data>
			<source name="statistics/" type="file" />
			<parsers>
				<parser type="tabular" />
			</parsers>
		</data>
		<row>
			<column field="Uploaded_file" label="Result File" type="text" width="12" />
			<column field="Found_PSMs" label="Total PSMs" preload="Yes" type="fdrview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="PSM_FDR" />
			</column>
			<column field="Invalid_PSM_rows" label="Invalid PSMs" preload="Yes" type="numberview" view="group_by_spectrum" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22valid_input%22%3A%22INVALID%22}" />
			</column>
			<column field="Peptide_rows" label="Peptides" preload="Yes" type="fdrview" view="group_by_peptide" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Found_Peptides" label="Peptides (Derived)" preload="Yes" type="fdrview" view="group_by_peptide_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Peptide_FDR" />
			</column>
			<column field="Protein_rows" label="Proteins" preload="Yes" type="fdrview" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column field="Found_Proteins" label="Proteins (Derived)" preload="Yes" type="fdrview" view="group_by_protein_derived" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="fdr" value="Protein_FDR" />
			</column>
			<column label="&quot;One-Hit Wonders&quot;" preload="Yes" tooltip="Proteins identified by exactly one peptide." type="view" value="View" view="group_by_protein" width="3">
				<parameter name="file" value="[File_descriptor]" />
				<parameter name="hash" value="#{%22Peptides_lowerinput%22%3A%221%22%2C%22Peptides_upperinput%22%3A%221%22}" />
			</column>
			<column label="PTMs" preload="Yes" tooltip="Spectrum identifications, grouped by unique sets of post-translational modifications." type="view" value="View" view="group_by_ptm" width="3">
				<parameter name="file" value="[File_descriptor]" />
			</column>
		</row>
	</block>

	
	<view display="hidden" id="group_by_spectrum">
		<blockRef id="main" type="spectrum_list" />
	</view>
	<block id="spectrum_list" type="table">
		<data>
			<source name="{file}" type="file" />
			<parsers>
				<parser type="mzTab" />
			</parsers>
			<processors>
				<processor type="mzTab" />
				<processor field="#SpecFile" type="fileDescriptor" />
				<processor field="nativeID" type="nativeID" />
				<processor field="internalFilename" newField="baseFilename" type="baseFilename" />
				<processor field="sequence" replace="L" replacedField="sequence_li" search="I" type="stringSubstitution" />
				<processor field="modified_sequence" replace="L" replacedField="modified_sequence_li" search="I" type="stringSubstitution" />
			</processors>
		</data>
		<row>
			<column field="PSM_ID" label="PSM ID" tooltip="PSM ID from within the source MzTab file" type="integer" width="3" />
			<column field="#SpecFile" label="Peak List File" tooltip="The name of the peak list file from which this spectrum came, as referenced from within the source MzTab file" type="text" width="12" />
			<column field="nativeID_index" label="Index" tooltip="Spectrum index (0-based) in the file." type="integer" width="3" />
			<column field="nativeID_scan" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="modified_sequence" label="Peptide" tooltip="The modified peptide sequence matched to this spectrum" type="text" width="18" />
			<column field="modifications" label="Modifications" tooltip="The positions and accessions of all post-translational modifications found for this spectrum identification" type="text" width="18" />
			<column field="accession" label="TopProtein" tooltip="The accession of the protein matched to this spectrum" type="text" width="18" />
			<column field="charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="search_engine" label="Search Engine" tooltip="Search engine used to generate this identification" type="text" width="12" />
			<column field="valid" label="Valid" tooltip="If a spectrum could not be found in the source peak list file, or if the identification contains any ambiguous PTM references, then it will be marked as &quot;INVALID&quot;." type="text" width="7" />
                <column label="Add to Library" type="genericurlgenerator" width="12"> \
                    <parameter name="URLBASE" value="/ProteoSAFe/addToLibrary.jsp" />\
                    <parameter name="REQUESTPARAMETER=file" value="[#SpecFile]" />\
                    <parameter name="REQUESTPARAMETER=scan" value="[nativeID_scan]" />\
                    <parameter name="REQUESTPARAMETER=index" value="[nativeID_index]" />\
                    <parameter name="REQUESTPARAMETER=charge" value="[charge]" />\
                    <parameter name="REQUESTPARAMETER=mass" value="[_dyn_#parent_mass]" />\
                    <parameter name="REQUESTPARAMETER=proteins" value="[accession]" />\
                    <parameter name="REQUESTPARAMETER=peptide" value="[modified_sequence]" />\
                    <parameter name="LABEL" value="Link" />\
                    <parameter name="USETASK" value="True" />\
                    <parameter name="PASS_URL" value="True" />\
                </column>
		</row>
		<row expander="image">
			<column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
				<parameter file="[internalFilename]" name="file" />
				<parameter name="scan" value="[nativeID_scan]" />
				<parameter name="index" value="[nativeID_index_1-based]" />
				<parameter name="peptide" value="[modified_sequence]" />
				<parameter name="modformat" value="inspect" />
				<parameter name="trim" value="true" />
			</column>
		</row>
		<row expander="down:up">
			<column block="psms_per_spectrum" colspan="9" type="block">
				<parameter name="file" value="{file}" />
				<parameter name="spectrum" value="[PSM_ID]" />
			</column>
		</row>
	</block>
	<block id="psms_per_spectrum" type="table_ss">
		<data>
			<source name="{file}" type="file" />
			<parsers>
				<parser type="mzTab" />
				<parser groupBy="PSM_ID" sliceBy="{spectrum}" type="slicedTabular" />
				<parser type="SQLite" />
			</parsers>
			<processors>
				<processor type="mzTab" />
				<processor field="#SpecFile" type="fileDescriptor" />
				<processor field="nativeID" type="nativeID" />
				<processor field="internalFilename" newField="baseFilename" type="baseFilename" />
				<processor field="sequence" replace="L" replacedField="sequence_li" search="I" type="stringSubstitution" />
				<processor field="modified_sequence" replace="L" replacedField="modified_sequence_li" search="I" type="stringSubstitution" />
			</processors>
		</data>
		<row>
			<column field="PSM_ID" label="PSM ID" tooltip="PSM ID from within the source MzTab file" type="integer" width="3" />
			<column field="accession" label="TopProtein" tooltip="The accession of the protein matched to this spectrum" type="text" width="18" />
			<column field="charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="search_engine" label="Search Engine" tooltip="Search engine used to generate this identification" type="text" width="12" />
			<column field="valid" label="Valid" tooltip="If a spectrum could not be found in the source peak list file, or if the identification contains any ambiguous PTM references, then it will be marked as &quot;INVALID&quot;." type="text" width="7" />
		</row>
		<row expander="image">
			<column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
				<parameter file="[internalFilename]" name="file" />
				<parameter name="scan" value="[nativeID_scan]" />
				<parameter name="index" value="[nativeID_index_1-based]" />
				<parameter name="peptide" value="[modified_sequence]" />
				<parameter name="modformat" value="inspect" />
				<parameter name="trim" value="true" />
			</column>
		</row>
	</block>

	
	<view display="hidden" id="group_by_peptide">
		<blockRef id="main" type="peptide_list" />
	</view>
	<view display="hidden" id="group_by_peptide_derived">
		<blockRef id="main" type="peptide_list" />
	</view>
	<block id="peptide_list" type="table_ss">
		<data>
			<source name="{file}" type="file" />
			<parsers>
				<parser type="mzTab" />
				<parser groupBy="variant" operator="min" selectBy="opt_global_EValue" type="representativeTabular" />
				<parser operator="ascending" sortBy="opt_global_EValue" type="sortedTabular" />
				<parser type="SQLite" />
			</parsers>
			<processors>
				<processor type="mzTab" />
				<processor field="#SpecFile" type="fileDescriptor" />
				<processor field="nativeID" type="nativeID" />
				<processor field="internalFilename" newField="baseFilename" type="baseFilename" />
				<processor field="sequence" replace="L" replacedField="sequence_li" search="I" type="stringSubstitution" />
				<processor field="modified_sequence" replace="L" replacedField="modified_sequence_li" search="I" type="stringSubstitution" />
			</processors>
		</data>
		<row>
			<column field="PSM_ID" label="PSM ID" tooltip="PSM ID from within the source MzTab file" type="integer" width="3" />
			<column field="#SpecFile" label="Peak List File" tooltip="The name of the peak list file from which this spectrum came, as referenced from within the source MzTab file" type="text" width="12" />
			<column field="nativeID_index" label="Index" tooltip="Spectrum index (0-based) in the file." type="integer" width="3" />
			<column field="nativeID_scan" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="sequence" label="Peptide" tooltip="The unmodified peptide sequence matched to this spectrum" type="text" width="18" />
			<column field="modified_sequence" label="Modified Peptide" tooltip="The modified peptide sequence matched to this spectrum" type="text" width="18" />
			<column field="modifications" label="Modifications" tooltip="The positions and accessions of all post-translational modifications found for this spectrum identification" type="text" width="18" />
			<column field="accession" label="TopProtein" tooltip="The accession of the protein matched to this spectrum" type="text" width="18" />
			<column field="charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="search_engine" label="Search Engine" tooltip="Search engine used to generate this identification" type="text" width="12" />
			<column field="valid" label="Valid" tooltip="If a spectrum could not be found in the source peak list file, or if the identification contains any ambiguous PTM references, then it will be marked as &quot;INVALID&quot;." type="text" width="7" />
		</row>
		<row expander="image">
			<column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
				<parameter file="[internalFilename]" name="file" />
				<parameter name="scan" value="[nativeID_scan]" />
				<parameter name="index" value="[nativeID_index_1-based]" />
				<parameter name="peptide" value="[modified_sequence]" />
				<parameter name="modformat" value="inspect" />
				<parameter name="trim" value="true" />
			</column>
		</row>
		<row expander="down:up">
			<column block="spectra_per_peptide" colspan="9" type="block">
				<parameter name="file" value="{file}" />
				<parameter name="variant" value="[variant]" />
			</column>
		</row>
	</block>
	<block id="spectra_per_peptide" type="table_ss">
		<data>
			<source name="{file}" type="file" />
			<parsers>
				<parser type="mzTab" />
				<parser groupBy="variant" sliceBy="{variant}" type="slicedTabular" />
				<parser type="SQLite" />
			</parsers>
			<processors>
				<processor type="mzTab" />
				<processor field="#SpecFile" type="fileDescriptor" />
				<processor field="nativeID" type="nativeID" />
				<processor field="internalFilename" newField="baseFilename" type="baseFilename" />
				<processor field="sequence" replace="L" replacedField="sequence_li" search="I" type="stringSubstitution" />
				<processor field="modified_sequence" replace="L" replacedField="modified_sequence_li" search="I" type="stringSubstitution" />
			</processors>
		</data>
		<row>
			<column field="PSM_ID" label="PSM ID" tooltip="PSM ID from within the source MzTab file" type="integer" width="3" />
			<column field="#SpecFile" label="Peak List File" tooltip="The name of the peak list file from which this spectrum came, as referenced from within the source MzTab file" type="text" width="12" />
			<column field="nativeID_index" label="Index" tooltip="Spectrum index (0-based) in the file." type="integer" width="3" />
			<column field="nativeID_scan" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="modified_sequence" label="Modified Peptide" tooltip="The modified peptide sequence matched to this spectrum" type="text" width="18" />
			<column field="modifications" label="Modifications" tooltip="The positions and accessions of all post-translational modifications found for this spectrum identification" type="text" width="18" />
			<column field="accession" label="TopProtein" tooltip="The accession of the protein matched to this spectrum" type="text" width="18" />
			<column field="charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="search_engine" label="Search Engine" tooltip="Search engine used to generate this identification" type="text" width="12" />
			<column field="valid" label="Valid" tooltip="If a spectrum could not be found in the source peak list file, or if the identification contains any ambiguous PTM references, then it will be marked as &quot;INVALID&quot;." type="text" width="7" />
		</row>
		<row expander="image">
			<column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
				<parameter file="[internalFilename]" name="file" />
				<parameter name="scan" value="[nativeID_scan]" />
				<parameter name="index" value="[nativeID_index_1-based]" />
				<parameter name="peptide" value="[modified_sequence]" />
				<parameter name="modformat" value="inspect" />
				<parameter name="trim" value="true" />
			</column>
		</row>
	</block>

	
	<view display="hidden" id="group_by_protein">
		<blockRef id="main" type="protein_list" />
	</view>
	<view display="hidden" id="group_by_protein_derived">
		<blockRef id="main" type="protein_list" />
	</view>
        <block id="protein_list" type="table_ss">
                <data>
                        <source name="{file}" type="file" />
                        <parsers>
                                <parser type="mzTab" />
                                <parser groupBy="accession" operator="min" selectBy="opt_global_EValue" type="representativeTabular" />
                                <parser operator="ascending" sortBy="opt_global_EValue" type="sortedTabular" />
                                <parser type="SQLite" />
                        </parsers>
                        <processors>
                                <processor type="mzTab" />
				<processor field="accession" type="protein" />
                                <processor field="#SpecFile" type="fileDescriptor" />
                                <processor field="nativeID" type="nativeID" />
                                <processor field="internalFilename" newField="baseFilename" type="baseFilename" />
                                <processor field="sequence" replace="L" replacedField="sequence_li" search="I" type="stringSubstitution" />
                                <processor field="modified_sequence" replace="L" replacedField="modified_sequence_li" search="I" type="stringSubstitution" />
                        </processors>
                </data>
                <row>
                        <column field="PSM_ID" label="PSM ID" tooltip="PSM ID from within the source MzTab file" type="integer" width="3" />
                        <column field="accession" label="TopProtein" preload="Yes" type="view" view="protein_details" width="18">
                                <parameter name="file" value="{file}" />
                                <parameter name="protein" value="[accession]" />
                        </column>
                        <column field="#SpecFile" label="Peak List File" tooltip="The name of the peak list file from which this spectrum came, as referenced from within the source MzTab file" type="text" width="12" />
                        <column field="nativeID_index" label="Index" tooltip="Spectrum index (0-based) in the file." type="integer" width="3" />
                        <column field="nativeID_scan" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
                        <column field="sequence" label="Peptide" tooltip="The unmodified peptide sequence matched to this spectrum" type="text" width="18" />
                        <column field="modified_sequence" label="Modified Peptide" tooltip="The modified peptide sequence matched to this spectrum" type="text" width="18" />
                        <column field="modifications" label="Modifications" tooltip="The positions and accessions of all post-translational modifications found for this spectrum identification" type="text" width="18" />
                        <column field="charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
                        <column field="search_engine" label="Search Engine" tooltip="Search engine used to generate this identification" type="text" width="12" />
                        <column field="valid" label="Valid" tooltip="If a spectrum could not be found in the source peak list file, or if the identification contains any ambiguous PTM references, then it will be marked as &quot;INVALID&quot;." type="text" width="7" />
                </row>
		<row expander="image">
			<column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
				<parameter file="[internalFilename]" name="file" />
				<parameter name="scan" value="[nativeID_scan]" />
				<parameter name="index" value="[nativeID_index_1-based]" />
				<parameter name="peptide" value="[modified_sequence]" />
				<parameter name="modformat" value="inspect" />
				<parameter name="trim" value="true" />
			</column>
		</row>
		<row expander="down:up">
			<column block="spectra_per_protein" colspan="9" type="block">
				<parameter name="file" value="{file}" />
				<parameter name="protein" value="[accession]" />
			</column>
		</row>
        </block>

	<view display="hidden" id="protein_details">
		<blockRef id="title" type="protein_title" />
		<blockRef id="main" type="spectra_per_protein" />
	</view>
	<block id="protein_title" type="title">
		<data><source type="value" value="Protein {protein}" /></data>
	</block>
	<block id="spectra_per_protein" type="table_ss">
		<data>
			<source name="{file}" type="file" />
			<parsers>
				<parser type="mzTab" />
				<parser fieldDelimiter=";" type="unrolledTabular" unrollBy="accession" />
				<parser groupBy="accession" numeric="false" sliceBy="{protein}" type="slicedTabular" />
				<parser type="SQLite" />
			</parsers>
			<processors>
				<processor type="mzTab" />
				<processor field="#SpecFile" type="fileDescriptor" />
				<processor field="nativeID" type="nativeID" />
				<processor field="internalFilename" newField="baseFilename" type="baseFilename" />
				<processor field="sequence" replace="L" replacedField="sequence_li" search="I" type="stringSubstitution" />
				<processor field="modified_sequence" replace="L" replacedField="modified_sequence_li" search="I" type="stringSubstitution" />
			</processors>
		</data>
		<row>
			<column field="PSM_ID" label="PSM ID" tooltip="PSM ID from within the source MzTab file" type="integer" width="3" />
			<column field="#SpecFile" label="Peak List File" tooltip="The name of the peak list file from which this spectrum came, as referenced from within the source MzTab file" type="text" width="12" />
			<column field="nativeID_index" label="Index" tooltip="Spectrum index (0-based) in the file." type="integer" width="3" />
			<column field="nativeID_scan" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="modified_sequence" label="Peptide" tooltip="The modified peptide sequence matched to this spectrum" type="text" width="18" />
			<column field="modifications" label="Modifications" tooltip="The positions and accessions of all post-translational modifications found for this spectrum identification" type="text" width="18" />
			<column field="charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="search_engine" label="Search Engine" tooltip="Search engine used to generate this identification" type="text" width="12" />
			<column field="valid" label="Valid" tooltip="If a spectrum could not be found in the source peak list file, or if the identification contains any ambiguous PTM references, then it will be marked as &quot;INVALID&quot;." type="text" width="7" />
		</row>
		<row expander="image">
			<column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
				<parameter file="[internalFilename]" name="file" />
				<parameter name="scan" value="[nativeID_scan]" />
				<parameter name="index" value="[nativeID_index_1-based]" />
				<parameter name="peptide" value="[modified_sequence]" />
				<parameter name="modformat" value="inspect" />
				<parameter name="trim" value="true" />
			</column>
		</row>
	</block>

	
	<view display="hidden" id="group_by_ptm">
		<blockRef id="main" type="ptm_list" />
	</view>
	<block id="ptm_list" type="table_ss">
		<data>
			<source name="{file}" type="file" />
			<parsers>
				<parser type="mzTab" />
				<parser fieldDelimiter="|" type="unrolledTabular" unrollBy="mod_set" />
				<parser groupBy="mod_set" numeric="false" type="groupedTabular" />
				<parser type="SQLite" />
			</parsers>
			<processors>
				<processor type="mzTab" />
				<processor field="modified_sequence" type="peptideCount" />
			</processors>
		</data>
		<row>
			<column field="mod_set" label="Post-Translational Modifications" preload="Yes" type="view" view="ptm_details" width="18">
				<parameter name="file" value="{file}" />
				<parameter name="mod_set" value="[mod_set]" />
				<parameter name="null_label" value="None" />
			</column>
			<column field="Hits" label="PSMs with this Modification" type="integer" width="2" />
			<column field="Peptides" label="Unique Unmodified Peptides" type="integer" width="2" />
			<column field="Modified" label="Unique Modified Peptides" type="integer" width="2" />
		</row>
	</block>

	<view display="hidden" id="ptm_details">
		<blockRef id="title" type="ptm_title" />
		<blockRef id="main" type="spectra_per_ptm" />
	</view>
	<block id="ptm_title" type="title">
		<data>
			<source type="value" value="Post-Translational Modifications: {mod_set}" />
		</data>
	</block>
	<block id="spectra_per_ptm" type="table_ss">
		<data>
			<source name="{file}" type="file" />
			<parsers>
				<parser type="mzTab" />
				<parser fieldDelimiter="|" type="unrolledTabular" unrollBy="mod_set" />
				<parser groupBy="mod_set" numeric="false" sliceBy="{mod_set}" type="slicedTabular" />
				<parser type="SQLite" />
			</parsers>
			<processors>
				<processor type="mzTab" />
				<processor field="#SpecFile" type="fileDescriptor" />
				<processor field="nativeID" type="nativeID" />
				<processor field="internalFilename" newField="baseFilename" type="baseFilename" />
				<processor field="sequence" replace="L" replacedField="sequence_li" search="I" type="stringSubstitution" />
				<processor field="modified_sequence" replace="L" replacedField="modified_sequence_li" search="I" type="stringSubstitution" />
			</processors>
		</data>
		<row>
			<column field="PSM_ID" label="PSM ID" tooltip="PSM ID from within the source MzTab file" type="integer" width="3" />
			<column field="#SpecFile" label="Peak List File" tooltip="The name of the peak list file from which this spectrum came, as referenced from within the source MzTab file" type="text" width="12" />
			<column field="nativeID_index" label="Index" tooltip="Spectrum index (0-based) in the file." type="integer" width="3" />
			<column field="nativeID_scan" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="modified_sequence" label="Modified Peptide" tooltip="The modified peptide sequence matched to this spectrum" type="text" width="18" />
			<column field="modifications" label="Modifications" tooltip="The positions and accessions of all post-translational modifications found for this spectrum identification" type="text" width="18" />
			<column field="accession" label="TopProtein" tooltip="The accession of the protein matched to this spectrum" type="text" width="18" />
			<column field="charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="search_engine" label="Search Engine" tooltip="Search engine used to generate this identification" type="text" width="12" />
			<column field="valid" label="Valid" tooltip="If a spectrum could not be found in the source peak list file, or if the identification contains any ambiguous PTM references, then it will be marked as &quot;INVALID&quot;." type="text" width="7" />
		</row>
		<row expander="image">
			<column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
				<parameter file="[internalFilename]" name="file" />
				<parameter name="scan" value="[nativeID_scan]" />
				<parameter name="index" value="[nativeID_index_1-based]" />
				<parameter name="peptide" value="[modified_sequence]" />
				<parameter name="modformat" value="inspect" />
				<parameter name="trim" value="true" />
			</column>
		</row>
	</block>
	

	
	<view display="hidden" group="Legacy Views" id="group_by_spectrum_old" label="Group by Spectrum">
		<blockRef id="main" type="spectrum_list_old" />
	</view>
	<view display="hidden" group="Legacy Views" id="group_by_peptide_old" label="Group by Peptide">
		<blockRef id="main" type="peptide_list_old" />
	</view>
	<view display="hidden" group="Legacy Views" id="group_by_protein_old" label="Group by Protein">
		<blockRef id="main" type="protein_list_old" />
	</view>
	<view display="hidden" id="protein_details_old">
		
		<blockRef id="main" type="spectra_per_protein_old" />
	</view>

	
	<block id="spectrum_list_old" type="table_ss">
		<data>
			<source name="result/" type="file" />
			<parsers>
				<parser operator="ascending" sortBy="FDR" type="sortedTabular" />
                <parser type="SQLite" />
			</parsers>
			<processors>
				<processor field="#SpecFile" type="uploadFilename" />
				<processor field="Protein" type="protein" />
			</processors>
		</data>
		<row>
			<column field="#SpecFile" label="Filename" tooltip="Spectrum file name" type="text" width="12" />
			<column field="SpecIndex" label="Index" tooltip="Spectrum index (1-based) in the file. The first spectrum has index 1, the second has index 2, and so on. For mzXML files this value is same as the scan number." type="integer" width="3" />
			<column field="Scan#" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="FragMethod" label="FragMethod" tooltip="Fragmentation method" type="text" width="3" />
			<column field="Peptide" label="Peptide" tooltip="Peptide sequence with neighboring amino acids" type="text" width="18" />
			<column field="ProteinID" label="Protein" tooltip="Protein name" type="text" width="18" />
			<column field="Charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="MSGFScore" label="Score" tooltip="MS-GF raw score of the peptide-spectrum match" type="integer" width="3" />
			<column field="P-value" label="DB P-Value" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;database&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
			<column field="FDR" label="FDR" precision="5" tooltip="False discovery rate" type="float" />
			<column field="PepFDR" label="PepFDR" precision="5" tooltip="Peptide-level false discovery rate estimated using the target-decoy approach" type="float" />
			<column field="SpecProb" label="SpecProb" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;peptide&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
		</row>
		<row expander="image">
			<column colspan="6" contentType="image/png" invoke="annotatedSpectrumImageThumbnail" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
			<column colspan="6" contentType="text/plain" invoke="annotatedSpectrumImageText" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
		</row>
	</block>

	<block id="peptide_list_old" type="table">
		<data>
			<source name="result/" type="file" />
			<parsers>
				<parser operator="ascending" sortBy="FDR" type="sortedTabular" />
				<parser groupBy="Peptide" operator="max" selectBy="MSGFScore" type="representativeTabular" />
			</parsers>
			<processors>
				<processor field="#SpecFile" type="uploadFilename" />
				<processor field="Protein" type="protein" />
			</processors>
		</data>
		<row>
			<column field="#SpecFile" label="Filename" tooltip="Spectrum file name" type="text" width="12" />
			<column field="SpecIndex" label="Index" tooltip="Spectrum index (1-based) in the file. The first spectrum has index 1, the second has index 2, and so on. For mzXML files this value is same as the scan number." type="integer" width="3" />
			<column field="Scan#" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="FragMethod" label="FragMethod" tooltip="Fragmentation method" type="text" width="3" />
			<column field="Peptide" label="Peptide" tooltip="Peptide sequence with neighboring amino acids" type="text" width="18" />
			<column field="ProteinID" label="Protein" tooltip="Protein name" type="text" width="18" />
			<column field="Charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="MSGFScore" label="Score" tooltip="MS-GF raw score of the peptide-spectrum match" type="integer" width="3" />
			<column field="P-value" label="DB P-Value" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;database&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
			<column field="FDR" label="FDR" precision="5" tooltip="False discovery rate" type="float" />
			<column field="PepFDR" label="PepFDR" precision="5" tooltip="Peptide-level false discovery rate estimated using the target-decoy approach" type="float" />
			<column field="SpecProb" label="SpecProb" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;peptide&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
		</row>
		<row expander="image">
			<column colspan="6" contentType="image/png" invoke="annotatedSpectrumImageThumbnail" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
			<column colspan="6" contentType="text/plain" invoke="annotatedSpectrumImageText" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
		</row>
		<row expander="down:up">
			<column block="spectra_per_peptide_old" colspan="12" type="block">
				<parameter name="peptide" value="[Peptide]" />
			</column>
		</row>
	</block>

	<block id="spectra_per_peptide_old" type="table">
		<data>
			<source name="result/" type="file" />
			<parsers>
				<parser operator="ascending" sortBy="FDR" type="sortedTabular" />
				<parser groupBy="Peptide" sliceBy="{peptide}" type="slicedTabular" />
			</parsers>
			<processors>
				<processor field="#SpecFile" type="uploadFilename" />
				<processor field="Protein" type="protein" />
			</processors>
		</data>
		<row>
			<column field="#SpecFile" label="Filename" tooltip="Spectrum file name" type="text" width="12" />
			<column field="SpecIndex" label="Index" tooltip="Spectrum index (1-based) in the file. The first spectrum has index 1, the second has index 2, and so on. For mzXML files this value is same as the scan number." type="integer" width="3" />
			<column field="Scan#" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="FragMethod" label="FragMethod" tooltip="Fragmentation method" type="text" width="3" />
			<column field="ProteinID" label="Protein" tooltip="Protein name" type="text" width="18" />
			<column field="Charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="MSGFScore" label="Score" tooltip="MS-GF raw score of the peptide-spectrum match" type="integer" width="3" />
			<column field="P-value" label="DB P-Value" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;database&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
			<column field="FDR" label="FDR" precision="5" tooltip="False discovery rate" type="float" />
			<column field="PepFDR" label="PepFDR" precision="5" tooltip="Peptide-level false discovery rate estimated using the target-decoy approach" type="float" />
			<column field="SpecProb" label="SpecProb" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;peptide&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
		</row>
		<row expander="image">
			<column colspan="6" contentType="image/png" invoke="annotatedSpectrumImageThumbnail" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
			<column colspan="5" contentType="text/plain" invoke="annotatedSpectrumImageText" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
		</row>
	</block>

	<block id="protein_list_old" type="table">
		<data>
			<source name="result/" type="file" />
			<parsers>
				<parser operator="ascending" sortBy="FDR" type="sortedTabular" />
				<parser groupBy="Protein" type="groupedTabular" />
			</parsers>
			<processors>
				<processor field="Protein" type="protein" />
				<processor field="Peptide" type="peptideCount" />
			</processors>
		</data>
		<row>
			<column field="ProteinID" label="Protein" type="view" view="protein_details_old" width="18">
				<parameter name="protein" value="[Protein]" />
				<parameter name="proteinID" value="[ProteinID]" />
			</column>
			<column field="Comment" label="Description" type="text" width="18" />
			<column field="Hits" label="Hits" type="integer" width="2" />
			<column field="Peptides" label="Unique Unmodified Peptides" type="integer" width="2" />
			<column field="Modified" label="Unique Modified Peptides" type="integer" width="2" />
		</row>
		<row expander="down:up">
			<column block="spectra_per_protein_old" colspan="5" type="block">
				<parameter name="protein" value="[Protein]" />
			</column>
		</row>
	</block>

	<block id="spectra_per_protein_old" type="table">
		<data>
			<source name="result/" type="file" />
			<parsers>
				<parser operator="ascending" sortBy="FDR" type="sortedTabular" />
				<parser groupBy="Protein" sliceBy="{protein}" type="slicedTabular" />
			</parsers>
			<processors>
				<processor field="#SpecFile" type="uploadFilename" />
				<processor field="Protein" type="protein" />
			</processors>
		</data>
		<row>
			<column field="#SpecFile" label="Filename" tooltip="Spectrum file name" type="text" width="12" />
			<column field="SpecIndex" label="Index" tooltip="Spectrum index (1-based) in the file. The first spectrum has index 1, the second has index 2, and so on. For mzXML files this value is same as the scan number." type="integer" width="3" />
			<column field="Scan#" label="Scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="FragMethod" label="FragMethod" tooltip="Fragmentation method" type="text" width="3" />
			<column field="Peptide" label="Peptide" tooltip="Peptide sequence with neighboring amino acids" type="text" width="18" />
			<column field="Charge" label="Charge" tooltip="Precursor ion charge" type="integer" width="1" />
			<column field="MSGFScore" label="Score" tooltip="MS-GF raw score of the peptide-spectrum match" type="integer" width="3" />
			<column field="P-value" label="DB P-Value" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;database&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
			<column field="FDR" label="FDR" precision="5" tooltip="False discovery rate" type="float" />
			<column field="PepFDR" label="PepFDR" precision="5" tooltip="Peptide-level false discovery rate estimated using the target-decoy approach" type="float" />
			<column field="SpecProb" label="SpecProb" precision="1" tooltip="Probability that a spectrum matches a random &lt;b&gt;peptide&lt;/b&gt; with a score equal to or exceeding the observed score" type="exponential" />
		</row>
		<row expander="image">
			<column colspan="6" contentType="image/png" invoke="annotatedSpectrumImageThumbnail" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
			<column colspan="5" contentType="text/plain" invoke="annotatedSpectrumImageText" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[Scan#]" />
				<parameter name="index" value="[SpecIndex]" />
				<parameter name="peptide" value="[Peptide]" />
				<parameter name="fragmentation" value="[FragMethod]" />
			</column>
		</row>
	</block>


	<view display="hidden" group="Histograms" id="da_error_histogram" label="Da Error Histogram">
            <blockRef id="main" type="da_error_histogram" />
    </view>
	<block columnname="PMError(Da)" id="da_error_histogram" type="histogramdisplayer" viewname="group_by_spectrum_old">
        <data>
            <source name="statistics/" type="file" />
            <parsers>
                <parser contentType="text/plain" type="stream" />
            </parsers>
        </data>
    </block>

	<view display="hidden" group="Histograms" id="ppm_error_histogram" label="PPM Error Histogram">
            <blockRef id="main" type="ppm_error_histogram" />
    </view>
	<block columnname="PMError(ppm)" id="ppm_error_histogram" type="histogramdisplayer" viewname="group_by_spectrum_old">
        <data>
            <source name="statistics/" type="file" />
            <parsers>
                <parser contentType="text/plain" type="stream" />
            </parsers>
        </data>
    </block>


    <view display="hidden" group="PSMs" id="merged_result_with_kl_with_ambiguity" label="view psms with ambiguity">
		<blockRef id="main" type="merged_result_with_kl_with_ambiguity" />
	</view>
	<block id="merged_result_with_kl_with_ambiguity" type="table_ss">
		<data>
			<source name="merged_result_with_kl_with_ambiguity/" type="file" />
			<parsers>
				<parser operator="ascending" sortBy="score" type="sortedTabular" />
                <parser type="SQLite" />
			</parsers>
			<processors>
				<processor field="filename" type="uploadFilename" />
			</processors>
		</data>
		<row>
			<column field="filename" label="filename" tooltip="Spectrum file name" type="text" width="12" />
			<column field="scan" label="scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="sequence" label="sequence" tooltip="Fragmentation method" type="text" width="3" />
			<column field="charge" label="charge" tooltip="Peptide sequence with neighboring amino acids" type="text" width="18" />
			<column field="kl_number" label="kl_number" precision="5" tooltip="False discovery rate" type="float" />
			<column field="ambiguity_total_score" label="ambiguity_total_score" precision="5" tooltip="False discovery rate" type="float" />
		</row>
		<row expander="image">
			<column colspan="6" contentType="image/png" invoke="annotatedSpectrumImageThumbnail" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[scan]" />
				<parameter name="peptide" value="[sequence]" />
			</column>
            <column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
                <parameter file="spec/[internalFilename]" name="file" />
                <parameter name="scan" value="[scan]" />
                <parameter name="peptide" value="[sequence]" />
                <parameter name="modformat" value="inspect" />
            </column>
		</row>
	</block>

    <view display="hidden" group="PSMs" id="group_by_spectrum_merged_result_with_kl_with_ambiguity" label="Spectra with Ambiguity">
		<blockRef id="main" type="group_by_spectrum_merged_result_with_kl_with_ambiguity" />
	</view>
	<block id="group_by_spectrum_merged_result_with_kl_with_ambiguity" type="table">
		<data>
			<source name="merged_result_with_kl_with_ambiguity/" type="file" />
			<parsers>
				<parser operator="ascending" sortBy="score" type="sortedTabular" />
                <parser groupBy="spectrum_unique_key" operator="max" selectBy="score" type="representativeTabular" />
			</parsers>
			<processors>
				<processor field="filename" type="uploadFilename" />
			</processors>
		</data>
		<row>
			<column field="filename" label="filename" tooltip="Spectrum file name" type="text" width="12" />
			<column field="scan" label="scan" tooltip="Spectrum scan number" type="integer" width="3" />
			<column field="sequence" label="sequence" tooltip="Fragmentation method" type="text" width="3" />
			<column field="charge" label="charge" tooltip="Peptide sequence with neighboring amino acids" type="text" width="18" />
            <column field="score" label="score" precision="5" tooltip="Score" type="float" />
			<column field="kl_number" label="kl_number" precision="5" tooltip="False discovery rate" type="float" />
			<column field="ambiguity_total_score" label="ambiguity_total_score" precision="5" tooltip="False discovery rate" type="float" />
            <column field="numberpsms" label="numberpsms" type="integer" />
            <column field="first_unique_intensity" label="first_unique_intensity" precision="5" tooltip="False discovery rate" type="float" />
            <column field="second_unique_intensity" label="second_unique_intensity" precision="5" tooltip="False discovery rate" type="float" />
		</row>
		<row expander="image">
			<column colspan="6" contentType="image/png" invoke="annotatedSpectrumImageThumbnail" type="stream">
				<parameter file="spec/[internalFilename]" name="file" />
				<parameter name="scan" value="[scan]" />
				<parameter name="peptide" value="[sequence]" />
			</column>
            <column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
                <parameter file="spec/[internalFilename]" name="file" />
                <parameter name="scan" value="[scan]" />
                <parameter name="peptide" value="[sequence]" />
                <parameter name="modformat" value="inspect" />
            </column>
		</row>
		<row expander="Show PSMs:Hide PSMs" expandericontype="text">
			<column block="psms_per_spectrum" colspan="12" type="block">
				<parameter name="spectrum_unique_key" value="[spectrum_unique_key]" />
			</column>
		</row>
	</block>


	<block id="psms_per_spectrum" type="table">
                <data>
                        <source name="merged_result_with_kl_with_ambiguity/" type="file" />
                        <parsers>
                                <parser operator="ascending" sortBy="opt_global_EValue" type="sortedTabular" />
				<parser groupBy="spectrum_unique_key" sliceBy="{spectrum_unique_key}" type="slicedTabular" />
                        </parsers>
                        <processors>
                                <processor field="filename" type="uploadFilename" />
                        </processors>
                </data>
                <row>
                        <column field="filename" label="filename" tooltip="Spectrum file name" type="text" width="12" />
                        <column field="scan" label="scan" tooltip="Spectrum scan number" type="integer" width="3" />
                        <column field="sequence" label="sequence" tooltip="Fragmentation method" type="text" width="3" />
                        <column field="charge" label="charge" tooltip="Peptide sequence with neighboring amino acids" type="text" width="18" />
            <column field="score" label="score" precision="5" tooltip="Score" type="float" />
                        <column field="kl_number" label="kl_number" precision="5" tooltip="False discovery rate" type="float" />
                        <column field="ambiguity_total_score" label="ambiguity_total_score" precision="5" tooltip="False discovery rate" type="float" />
            <column field="numberpsms" label="numberpsms" type="integer" />
                </row>
                <row expander="image">
                        <column colspan="6" contentType="image/png" invoke="annotatedSpectrumImageThumbnail" type="stream">
                                <parameter file="spec/[internalFilename]" name="file" />
                                <parameter name="scan" value="[scan]" />
                                <parameter name="peptide" value="[sequence]" />
                        </column>
                        <column colspan="20" height="500" type="jscolumnspectrumviewer" width="600">
            				<parameter file="spec/[internalFilename]" name="file" />
            				<parameter name="scan" value="[scan]" />
            				<parameter name="peptide" value="[sequence]" />
            				<parameter name="modformat" value="inspect" />
            			</column>
                </row>
        </block>

        <view display="hidden" group="Scatter Plots" id="kl_strict_vs_ambiguity_score" label="KL Strict vs Ambiguity">
            <blockRef id="main" type="kl_strict_vs_ambiguity_score" />
        </view>
        <block id="kl_strict_vs_ambiguity_score" type="scatterplotdisplayer" viewname="group_by_spectrum_merged_result_with_kl_with_ambiguity" xname="kl_strict" yname="ambiguity_total_score">
            <data>
                <source name="library_coverage_summary_statistics/" type="file" />
    	        <parsers>
    	            <parser contentType="text/plain" type="stream" />
    	        </parsers>
        	</data>
        </block>

        <view display="hidden" group="Scatter Plots" id="kl_strict_vs_kl_interpeak" label="KL Strict vs KL Interpeak">
            <blockRef id="main" type="kl_strict_vs_kl_interpeak" />
        </view>
        <block id="kl_strict_vs_kl_interpeak" type="scatterplotdisplayer" viewname="group_by_spectrum_merged_result_with_kl_with_ambiguity" xname="kl_strict" yname="kl_interpeak">
            <data>
                <source name="library_coverage_summary_statistics/" type="file" />
    	        <parsers>
    	            <parser contentType="text/plain" type="stream" />
    	        </parsers>
        	</data>
        </block>

        <view display="hidden" group="Scatter Plots" id="kl_unstrict_vs_kl_interpeak" label="KL UnStrict vs KL Interpeak">
            <blockRef id="main" type="kl_unstrict_vs_kl_interpeak" />
        </view>
        <block id="kl_unstrict_vs_kl_interpeak" type="scatterplotdisplayer" viewname="group_by_spectrum_merged_result_with_kl_with_ambiguity" xname="kl_unstrict" yname="kl_interpeak">
            <data>
                <source name="library_coverage_summary_statistics/" type="file" />
    	        <parsers>
    	            <parser contentType="text/plain" type="stream" />
    	        </parsers>
        	</data>
        </block>

        <view display="hidden" group="Scatter Plots" id="kl_strict_vs_kl_unstrict" label="KL Strict vs KL UnStrict">
            <blockRef id="main" type="kl_strict_vs_kl_unstrict" />
        </view>
        <block id="kl_strict_vs_kl_unstrict" type="scatterplotdisplayer" viewname="group_by_spectrum_merged_result_with_kl_with_ambiguity" xname="kl_strict" yname="kl_unstrict">
            <data>
                <source name="library_coverage_summary_statistics/" type="file" />
    	        <parsers>
    	            <parser contentType="text/plain" type="stream" />
    	        </parsers>
        	</data>
        </block>


        <view display="hidden" group="Histograms" id="KLStrictHistogram" label="KL Strict Histogram">
                <blockRef id="main" type="KLStrictHistogram" />
        </view>
    	<block columnname="kl_strict" id="KLStrictHistogram" type="histogramdisplayer" viewname="group_by_spectrum_merged_result_with_kl_with_ambiguity">
            <data>
                <source name="statistics/" type="file" />
                <parsers>
                    <parser contentType="text/plain" type="stream" />
                </parsers>
            </data>
        </block>

        <view display="hidden" group="Histograms" id="KLUnStrictHistogram" label="KL UnStrict Histogram">
                <blockRef id="main" type="KLUnStrictHistogram" />
        </view>
    	<block columnname="kl_unstrict" id="KLUnStrictHistogram" type="histogramdisplayer" viewname="group_by_spectrum_merged_result_with_kl_with_ambiguity">
            <data>
                <source name="statistics/" type="file" />
                <parsers>
                    <parser contentType="text/plain" type="stream" />
                </parsers>
            </data>
        </block>

  <block id="msstats_evidence_block" type="table_ss">
       <data>
        <source name="msstats_input_isobaric_tag/" type="file" />
        <parsers>
          <parser type="genericTabular" />
          <parser type="SQLite" />
         </parsers>
        <row>
        </row>
       </data>
</block>

</interface>
